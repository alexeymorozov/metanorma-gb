<div class="rule"></div>

<div class="toc">
  <h1 class="toc-contents">目 次</h1>
  <ul id="toc-list"></ul>
</div>

<div class="rule"></div>

<script type="text/javascript"
  src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
</script>

<script>
// http://tutorials.jenkov.com/jquery/generating-table-of-contents.html
$(document).ready(function() {
  $("#toc-list").empty();

  var prevH2Item = null;
  var prevH2List = null;

  var index = 0;
  $("h1, h2").each(function() {

    if ($(this).hasClass("toc-contents")) {
      return;
    }
    //insert an anchor to jump to, from the TOC link.
    var anchor = "<a name='" + index + "'></a>";
    $(this).before(anchor);

    var li     = "<li><a href='#" + index + "'>" + $(this).text() + "</a></li>";

    if ($(this).is("h1") ){
      prevH2List = $("<ul></ul>");
      prevH2Item = $(li);
      prevH2Item.append(prevH2List);
      prevH2Item.appendTo("#toc-list");
    } else {
      prevH2List.append(li);
    }
    index++;
  });
});
</script>
